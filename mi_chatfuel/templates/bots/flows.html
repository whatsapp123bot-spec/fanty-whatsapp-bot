<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OptiChat ‚Äî Flujos</title>
  <style>
    :root { --bg:#0f172a; --card:#0b1220; --muted:#94a3b8; --text:#e2e8f0; --accent:#7c3aed; --accent2:#22c55e; }
    * { box-sizing:border-box; }
    body { margin:0; background:linear-gradient(180deg, #0b1220, #0f172a); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    header { padding:18px 22px; display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid rgba(255,255,255,.06); position:sticky; top:0; background:rgba(11,18,32,.7); backdrop-filter: blur(8px); }
    .brand { display:flex; align-items:center; gap:10px; font-weight:800; font-size:18px; letter-spacing:.3px; }
    .brand .dot { width:10px; height:10px; border-radius:50%; background: radial-gradient(circle at 30% 30%, #a78bfa, #7c3aed); box-shadow: 0 0 12px rgba(124,58,237,.8); }
    .container { max-width: 1000px; margin: 24px auto; padding: 0 16px; }
    .toolbar { display:flex; align-items:center; justify-content:space-between; margin-bottom:14px; }
    .title { font-size:20px; font-weight:800; }
    .muted { color: var(--muted); font-size:13px; }
    .btn { appearance:none; border:0; border-radius:10px; padding:10px 14px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); color:#fff; font-weight:700; cursor:pointer; box-shadow: 0 8px 24px rgba(124,58,237,.25); text-decoration:none; display:inline-block; }
    .btn.minor { background:#111827; color:#e5e7eb; border:1px solid rgba(255,255,255,.08); box-shadow:none; }
    .list { display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:14px; }
    .card { background: radial-gradient(1200px 600px at 0% -10%, rgba(124,58,237,.08), transparent 60%), radial-gradient(1000px 500px at 120% 120%, rgba(34,197,94,.06), transparent 50%), var(--card); border:1px solid rgba(255,255,255,.06); border-radius:16px; padding:14px; display:flex; flex-direction:column; gap:10px; }
    .card h3 { margin:0; font-size:16px; font-weight:800; letter-spacing:.2px; display:flex; align-items:center; gap:8px; }
    .chip { font-size:11px; padding:2px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.12); color:#cbd5e1; }
    .chip.on { background: rgba(34,197,94,.12); border-color: rgba(34,197,94,.35); color:#bbf7d0; }
    .chip.off { background: rgba(148,163,184,.12); }
    .row { display:flex; align-items:center; gap:8px; justify-content:space-between; color:var(--muted); font-size:12px; }
    .actions { display:flex; flex-wrap:wrap; gap:8px; }
  </style>
</head>
<body>
  <header>
    <div class="brand"><span class="dot"></span> {{ brand }} <span class="muted">Flujos de {{ bot.name }}</span></div>
    <nav class="actions">
      <a class="btn minor" href="/panel/">‚Üê Volver</a>
      <a class="btn minor" href="/panel/live-chat/?bot={{ bot.id }}">üí¨ Chat en vivo</a>
      <a class="btn" href="/panel/bots/{{ bot.id }}/flows/new/">+ Nuevo Flujo</a>
    </nav>
  </header>

  <div class="container">
    <div class="toolbar">
      <div>
        <div class="title">Flujos de {{ bot.name }}</div>
        <div class="muted">Gestiona y edita tus flujos con el Builder visual</div>
      </div>
    </div>

    {% if flows %}
      <div class="list">
        {% for f in flows %}
          <div class="card">
            <h3>
              {{ f.name }}
              {% if f.is_active %}<span class="chip on">Activo</span>{% else %}<span class="chip off">Inactivo</span>{% endif %}
            </h3>
            <div class="row">
              <div>Actualizado</div>
              <div>{{ f.updated_at|date:"Y-m-d H:i" }}</div>
            </div>
            <div class="actions">
              <a class="btn" href="/panel/bots/{{ bot.id }}/flows/{{ f.id }}/builder/">Abrir Builder</a>
              <!-- Si alguna vez se requiere el editor b√°sico, se podr√≠a restaurar este link:
              <a class="btn minor" href="/panel/bots/{{ bot.id }}/flows/{{ f.id }}/edit/">Editor b√°sico</a>
              -->
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="card" style="text-align:center; padding:24px;">
        A√∫n no tienes flujos. Crea uno nuevo para empezar.
        <div style="margin-top:14px;"><a class="btn" href="/panel/bots/{{ bot.id }}/flows/new/">+ Nuevo Flujo</a></div>
      </div>
    {% endif %}
  </div>
</body>
</html>
